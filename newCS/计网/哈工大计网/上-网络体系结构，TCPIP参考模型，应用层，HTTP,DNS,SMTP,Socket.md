# 计算机网络之网尽其用

## 1 计算机网络概述

### 1.1 什么是计算机网络

- **计算机网络是通信技术与计算机技术紧密结合的产物**

![](https://picgo-picture-storage.oss-cn-guangzhou.aliyuncs.com/img/a646dd729a94465597140a07de9fa5c6.png)

- **计算机网络就是一种通信网络**

![](https://picgo-picture-storage.oss-cn-guangzhou.aliyuncs.com/img/de00aa4eeacd4a309f08cb3d0561ed39.png)

- **通过交换网络互连主机**  
    ![在这里插入图片描述](https://picgo-picture-storage.oss-cn-guangzhou.aliyuncs.com/img/72ef4e1a855c49d9b522ae070998118b.png)
    
- **什么是Internet？----组成细节角度**
  

![](https://img-blog.csdnimg.cn/8ea6647c7d6f42a7bc9b1d4a7a4d5cd3.png)

- **什么是Internet？—服务角度**  
    ![在这里插入图片描述](https://img-blog.csdnimg.cn/f3201e5cead74ea3b9a37c5971f7a802.png)

### 1.2 [网络协议](https://so.csdn.net/so/search?q=%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE&spm=1001.2101.3001.7020)

> - 协议是计算机网络有序运行的重要保证
>     - 硬件（主机、路由器、通信链路等）是计算机网络的基础；
>     - 计算机网络中的数据交换必须遵守事先约定好的规则；

- **网络协议（network protocol）定义**
  
    - **网络协议是以进行网络中的数据交换而建立的规则、标准或约定；**
    - **协议**规定了通信实体之间所交换的消息的**格式、意义、顺序**以及针对收到消息或发生的事件所采取的“**动作”（actions）；**
- **协议三要素**  
    ![在这里插入图片描述](https://img-blog.csdnimg.cn/b93e385e0f2f4978aa7f125576fed70d.png)
    
- **协议是计算机网络的重要内容**
  
- **Internet协议标准**
  
    - RFC（Request for Comments），
    - IEIF：互联网工程任务组（Internet Engineering Task Force）；

### 1.3 计算机网络结构

![在这里插入图片描述](https://img-blog.csdnimg.cn/6a325356b8f64c1e845d96a061838042.png)

#### 1.3.1 网络边缘

![在这里插入图片描述](https://img-blog.csdnimg.cn/4f9632c5bcc442b1a246a0e2dcbb1256.png)

#### 1.3.2 接入网络

![在这里插入图片描述](https://img-blog.csdnimg.cn/6e8fd41c52f74fcd81e98d2cfe8b0a67.png)

- **1、接入网络：数字用户线路（DSL）（电话线）**

![在这里插入图片描述](https://img-blog.csdnimg.cn/d42f640172e04ce28e42afc28f079332.png)

- **2、接入网络：电缆网络（有线电视）**

![在这里插入图片描述](https://img-blog.csdnimg.cn/731055bce2204d22a9afa91f1dcc730c.png)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/1c53e4b309fa49c8bec2a1f85e37bd71.png)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/318ce19c15f44b32b2f8f53965de56f4.png)

- **3、机构（企业）接入网络（Ethernet）**

![](https://img-blog.csdnimg.cn/b530c3d844f44713a2c9c4dbb1f5cae4.png)

- **4、无线接入网络（WIFI和4G）**  
    ![在这里插入图片描述](https://img-blog.csdnimg.cn/0aae9c4e3f4b489c9e56c4a4fb51c805.png)

#### 1.3.3 网络核心

![在这里插入图片描述](https://img-blog.csdnimg.cn/f0a1ee41f3314a969d30a56d20b680d4.png)

- **网络核心解决的基本问题就是数据交换**

### 1.4 Internet结构：网络之网络

![在这里插入图片描述](https://img-blog.csdnimg.cn/063205c37aa2415d9f0b5debe877f07c.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/54d86f33cd2e480eb45b86444d6aa987.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/f9b9aa09396e4028bcde65e38387f8a5.png)

![](https://img-blog.csdnimg.cn/680c8cfa466c4becbed3ae0848001724.png)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/9625b5fb20464a35a8a937221611892b.png)

- **总结目前网络状况-Internet网络**  
    ![在这里插入图片描述](https://img-blog.csdnimg.cn/7b707b581a7e4e679c4a0a0833cbc121.png)

### 1.5 数据交换

- **网络核心解决的重要问题：数据交换**

![在这里插入图片描述](https://img-blog.csdnimg.cn/83328eac75ad4653bf9844adafcc28d5.png)

- **数据交换的类型**
    - **电路交换**
    - **报文交换**
    - **分组交换**

#### 1.5.1 电路交换

- **1、电路交换的特点**

![在这里插入图片描述](https://img-blog.csdnimg.cn/0ee8b1a2afe546979b74b867dfdbc1d8.png)

- **2、电路交换网络的链路共享？**

![在这里插入图片描述](https://img-blog.csdnimg.cn/e22c5317407547b4a689ebf6729c3492.png)

- **3、多路复用技术**

![在这里插入图片描述](https://img-blog.csdnimg.cn/e37a6badfba04779a0e45c11d73bd4de.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/cdd3806971bf4b92b149ae03357d5ec1.png)

- **4、多路复用技术—频分多路复用FDM**

![在这里插入图片描述](https://img-blog.csdnimg.cn/713ae54bf2634563ace5156b197a363f.png)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/a00f5a56a26445a39863511b293457d9.png)

- **5、多路复用技术—时分多路复用TDM**

![在这里插入图片描述](https://img-blog.csdnimg.cn/7733a4ce3c9b4f488bcdecbdddbe3cba.png)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/db2b41bfed7c4fc981f9f7be16ca8fdd.png)

- **6、多路复用技术—波分多路复用WDM**

![在这里插入图片描述](https://img-blog.csdnimg.cn/0b82d83dcded44f9bea6ddcc0d2c9637.png)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/2901ebc640cb42068f54a6bf6c4d2cfd.png)

- **7、多路复用技术—码分多路复用CDM**

![在这里插入图片描述](https://img-blog.csdnimg.cn/0bb40277bc384d48a0523b30c26c8cf5.png)

> - 不同用户之间相乘（正交）只会得到0；

![在这里插入图片描述](https://img-blog.csdnimg.cn/5c9de48ba72c42709ab179dc82a10696.png)

> - 一个用户发送时：  
>     ![在这里插入图片描述](https://img-blog.csdnimg.cn/caf0c58d7dc44e168fc54666604c6700.png)
> - 多个用户发送时

![](https://img-blog.csdnimg.cn/b8a8857b709d43879243e17156949d21.png)

#### 1.5.2 报文、[分组交换](https://so.csdn.net/so/search?q=%E5%88%86%E7%BB%84%E4%BA%A4%E6%8D%A2&spm=1001.2101.3001.7020)

> - 报文是一个整体进行传输；

![在这里插入图片描述](https://img-blog.csdnimg.cn/d9d2709980cd4f938d461cc85aa464e3.png)

> - 分组是拆分报文成小数据包（会加上一些信息）

![在这里插入图片描述](https://img-blog.csdnimg.cn/1d3229fa11e44f88adeb7978b5ce43cf.png)

- **1、分组交换：统计多路复用**

![在这里插入图片描述](https://img-blog.csdnimg.cn/1a1217999cf74a9084235ce5fa79da12.png)

> - 并不是事先分配好的，随机分配，**按需共享链路**

- **2、存储-转发**  
    ![在这里插入图片描述](https://img-blog.csdnimg.cn/0c63628c055546b8b7295ac6ea785f6a.png)

> - 为了比较以上报文交换和分组交换的优缺点，首先引入计算分组交换的传输延迟；

- **3、分组交换：传输延迟**  
    ![在这里插入图片描述](https://img-blog.csdnimg.cn/f2b6fd3114eb4d689985f1ebf7117750.png)
    
- **4、报文交换 vs 分组交换**
  

![在这里插入图片描述](https://img-blog.csdnimg.cn/5dd830d31451431fb477c9b24ade93a9.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/e10a8545b7d54c418566eb62bc477a85.png)

> - 报文交换的方式，需要中间路由器缓存至少7.5Mbits

![在这里插入图片描述](https://img-blog.csdnimg.cn/8b5e3bd06f3d454c8903ca8238426042.png)

> - 分组交换中间路由器缓存也少很多，目前主要以分组交换的方式为主；

- **5、分组交换的报文交付时间**

![](https://img-blog.csdnimg.cn/be9bfd25ad3243fcbe2f0e529a86a25b.png)

- **6、分组交换（统计） vs 电路交换（复用）**

![在这里插入图片描述](https://img-blog.csdnimg.cn/d4fb176291c2487db6bdf3e75dba7834.png)

> - 电路交换需要提前建立连接，占用不释放是不可以被其他用户使用的；
> - 分组交换，不预先分配，按需分配；

![在这里插入图片描述](https://img-blog.csdnimg.cn/b54fa375cb504b91a29bf77a90561a4a.png)

### 1.6 计算机网络性能

#### 1.6.1 速率（b/s）

![在这里插入图片描述](https://img-blog.csdnimg.cn/7833d39c9e584c6eb3f0ee99740f68ad.png)

#### 1.6.2 带宽（b/s）

![在这里插入图片描述](https://img-blog.csdnimg.cn/b03c8445db8e4ad0ad89c69a19c03cfa.png)

#### 1.6.3 延迟/时延（delay/latency）

![在这里插入图片描述](https://img-blog.csdnimg.cn/3b22d9bb3d2d441d932b8dfb9425f8ea.png)

- **四种分组延迟**

![在这里插入图片描述](https://img-blog.csdnimg.cn/9288c8eb700c42c4bb99deb458e72931.png)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/9e3f143ef4e64d93988017e5afa69b9d.png)

> - **传输延迟：发出去的时延；（整个车队通过收费站时间）**
> - **传播延迟：在路上传输的时延；**

![在这里插入图片描述](https://img-blog.csdnimg.cn/1e8fbe15a1f544e9bfde62344db0751e.png)

> - 排队延迟（具有随机性）

![在这里插入图片描述](https://img-blog.csdnimg.cn/c3998e2890984e9f88f2be52ddec4c46.png)

#### 1.6.4 时延带宽积

> - 带宽（bps）最高传输速率

![在这里插入图片描述](https://img-blog.csdnimg.cn/f7c905e0c24740399afee72c05da3474.png)

#### 1.6.5 丢包率

- **分组丢失（丢包）**

![在这里插入图片描述](https://img-blog.csdnimg.cn/918bdd54910549b2aacc8c0130cfd045.png)

#### 1.6.6 吞吐量/率（Throughput）

![在这里插入图片描述](https://img-blog.csdnimg.cn/13cdba9a4b6249e39aa5cd41083bccdc.png)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/7a8799e3410640418aadf2218a98109f.png)

## 2 计算机网络体系结构

### 2.1 计算机网络体系

![在这里插入图片描述](https://img-blog.csdnimg.cn/45b9379b05fa4bdc93e094ed630e2499.png)

- **1、网络体系结构是从功能上描述计算机网络结构**

![在这里插入图片描述](https://img-blog.csdnimg.cn/464973809d8d478c84a7a316734f8ce7.png)

- **2、分层结构**  
    ![在这里插入图片描述](https://img-blog.csdnimg.cn/35c79cec73044674a0acd1442839ba9e.png)

> - 分层过多会导致效率降低；

- **3、分层网络体系结构基本概念**

![在这里插入图片描述](https://img-blog.csdnimg.cn/0678ed9e3e3c473d9eb353af35e9f745.png)

### 2.2 OSI参考模型

#### 2.2.1 OSI标准

![在这里插入图片描述](https://img-blog.csdnimg.cn/6cdb6ac146ce4fefbe6a3f714a7bda58.png)

- **1、OSI参考模型解释的通信过程**

![在这里插入图片描述](https://img-blog.csdnimg.cn/6ce4a747a2e44751a5cba6584975ac9f.png)

> - 实线连接的部分是真正传输物理的部分通路；
> - 虚线是对等层之间的逻辑数据传输；

- **2、OSI参考模型数据封装与通信过程**

![在这里插入图片描述](https://img-blog.csdnimg.cn/0bff11d220024b9db4a2520701708f23.png)

- **3、为什么要数据封装？**

![在这里插入图片描述](https://img-blog.csdnimg.cn/da6979e8667e48f8a9135140f22c4fc2.png)

#### 2.2.2 物理层功能-1bit传输

![在这里插入图片描述](https://img-blog.csdnimg.cn/13074b1feafa4ce5bb2b59335bef882f.png)

#### 2.2.3 数据链路层功能

> - 同一物理链路直接相连的两个结点的数据传输；

![在这里插入图片描述](https://img-blog.csdnimg.cn/d285f5a67b154724b64c4c8750940929.png)

> - 地址信息在数据链路层；
> - 两个结点为什么需要地址寻址，如下图所示：

![在这里插入图片描述](https://img-blog.csdnimg.cn/ef3ff92e971c42d7bc38a3bd3d364a32.png)

> - 只有自己地址匹配才会接收；

#### 2.2.4 网络层功能

![在这里插入图片描述](https://img-blog.csdnimg.cn/077b2c3a2bd04e2faf44b42c4e89366e.png)  
![](https://img-blog.csdnimg.cn/c9cf832a374b44ef87dd96e29fb29c20.png)

#### 2.2.5 传输层功能

> - 需要将完整报文分割成段；第一个端到端的控制；

![在这里插入图片描述](https://img-blog.csdnimg.cn/91a2973ce8b94834b8ab64c9f46ddba3.png)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/0973f671b2f64d9795f67a92a271cc93.png)

#### 2.2.6 会话层功能

> - 插入控制信息，会话层功能单薄，实际是不单独存在的

![在这里插入图片描述](https://img-blog.csdnimg.cn/c623a3a685ac43d58fff72dd39e4d3c5.png)

#### 2.2.7 表示层功能

![在这里插入图片描述](https://img-blog.csdnimg.cn/dda236f77dea42cc843199d25356881c.png)

#### 2.2.8 应用层功能

![在这里插入图片描述](https://img-blog.csdnimg.cn/dbc568d1bfb84633bd8c51263d0412d1.png)

### 2.3 TCP/IP参考模型

> - 先实现后总结出的模型；

![在这里插入图片描述](https://img-blog.csdnimg.cn/29a62ed92e1e4bf4aca585ce1959b09a.png)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/f399eaab6ac64f21a496d9d117e1bd3c.png)

### 2.4 5层参考模型

![在这里插入图片描述](https://img-blog.csdnimg.cn/e0ba9481195a450d8c7c326bb878621b.png)

#### 2.4.1 5层模型的数据封装

![在这里插入图片描述](https://img-blog.csdnimg.cn/a29dfe7be0a24a20a23ba67955199da0.png)

> - 此处可以很好地反映交换机和路由器的区别；
> - 报文->段（拆分报文，加上段头）->数据报（网络层）-> 帧（链路层）->bit（物理层）；
> - 网络层功能：路由，逻辑寻址，分组转发

### 2.5 计算机网络与Internet发展历史

![在这里插入图片描述](https://img-blog.csdnimg.cn/d7d9799b3b1c40829a35cbf7a3ae32da.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/7d70e0d79749433e810d7187020bae03.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/dfc74eda5ef04a8bab5b1ea67d158844.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/dcb51b86f02844119d2279b58b1e3aca.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/393bbc26d68a4c1a913b96afaeb57315.png)

## 3 应用层

> - 学习内容

![在这里插入图片描述](https://img-blog.csdnimg.cn/607a68518d2f410299517e5f3a823f8a.png)

### 3.1 网络应用概述

#### 3.1.1 网络应用的三种体系结构

![在这里插入图片描述](https://img-blog.csdnimg.cn/4e13e25f5bc946e796d57e0ead955229.png)

- **1、客户机/服务器结构**

![在这里插入图片描述](https://img-blog.csdnimg.cn/a432338448b2458488f57b599dbb1967.png)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/de7c2580ff854cbebb15b436cc36e395.png)

- **2、纯P2P结构**

![在这里插入图片描述](https://img-blog.csdnimg.cn/afc7153bf2794b579063ab769f5d03da.png)

- **3、混合结构**

![在这里插入图片描述](https://img-blog.csdnimg.cn/3a944fecd42d469faf6d2be5a1598345.png)

#### 3.1.2 网路应用进程通信

- **1、网路应用的基础：进程间通信**

![在这里插入图片描述](https://img-blog.csdnimg.cn/a66f09371afb464982d3e7e28a43308e.png)

- **2、套接字：Socket**

![在这里插入图片描述](https://img-blog.csdnimg.cn/bad51d006217435591c694983349d1d8.png)

- **3、如何寻址进程：：IP地址+端口号**

![在这里插入图片描述](https://img-blog.csdnimg.cn/5c0b870d39a94dc88dac4ad515df3865.png)

- **4、应用层协议**

![在这里插入图片描述](https://img-blog.csdnimg.cn/e43fa88158f74d518c24c12ac1e2af2a.png)

- **5、应用层协议的内容**

![在这里插入图片描述](https://img-blog.csdnimg.cn/c4d88f0e97824399a08ac0658ed298d1.png)

#### 3.1.3 网络应用需求与传输层服务

- **1、网络应用的需求指标**

![在这里插入图片描述](https://img-blog.csdnimg.cn/f8c731abacdc453eb8c51bf4fbe604e8.png)

- **2、Internet提供的传输服务**

![在这里插入图片描述](https://img-blog.csdnimg.cn/1d41a1eaed5a4756926d49d6aa2f152e.png)

- **3、典型网络应用所使用的传输层服务**

![在这里插入图片描述](https://img-blog.csdnimg.cn/24a7754c718049feb7787fc81f2ee7ce.png)

### 3.2 WEB应用(HTTP,Cookie)

#### 3.2.1 WEB应用概述

> - World Wide Web

- **1、Web与HTTP**

![在这里插入图片描述](https://img-blog.csdnimg.cn/dcc0f28e388649969544f2180854ed32.png)

> - Web所遵循的协议就是HTTP协议；
> - 超文本传输协议，HyperText Transfer Protocol

- **2、HTTP协议概述**

![在这里插入图片描述](https://img-blog.csdnimg.cn/3a3d74ff5fee48aa8a9b2524a5f7c04a.png)

> - 使用传输层的TCP协议  
>     ![在这里插入图片描述](https://img-blog.csdnimg.cn/f80a50f20cd3436a8c66992ba2571136.png)

> - 无状态不维护过去的状态，不记录历史信息；

#### 3.2.2 HTTP协议连接类型

![在这里插入图片描述](https://img-blog.csdnimg.cn/6d77542c296440a7b90964cdb3a263fb.png)

- **1、非持久性连接（每次只允许传输一个对象）**

![在这里插入图片描述](https://img-blog.csdnimg.cn/0c622d5ace834f4f92fb7bf0e56d0fb8.png)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/0fe04dbc029e493d9c6992b40df572a7.png)

- **2、响应时间分析与建模**

![在这里插入图片描述](https://img-blog.csdnimg.cn/74405468e85c458793b980fbb815942c.png)

- **3、持久性HTTP**  
    ![在这里插入图片描述](https://img-blog.csdnimg.cn/9f5391a28aa74e799a3898b9069d6b46.png)

#### 3.2.3 HTTP请求消息格式

- **1、HTTP请求消息**

![在这里插入图片描述](https://img-blog.csdnimg.cn/388ee176913c47f19a5e6f14b2945f08.png)

> - 请求行+请求头+请求空行+请求主体

- **2、HTTP请求消息的通用格式**  
    ![在这里插入图片描述](https://img-blog.csdnimg.cn/6b1e7ad3f40c4e9eb2fde1df7346288d.png)
    
- **3、上传输入的方法**
  

![在这里插入图片描述](https://img-blog.csdnimg.cn/c661592da7a44c52a65a504c36e21997.png)

- **4、方法的类型**  
    ![在这里插入图片描述](https://img-blog.csdnimg.cn/62db6ffcd48a40fb804a84b2b026c636.png)

#### 3.2.4 HTTP响应消息格式

- **1、HTTP响应格式**

![在这里插入图片描述](https://img-blog.csdnimg.cn/0bee0eadb70741dba1abfcf219102937.png)

> - 状态行+头部行+空行+响应消息主体

- **2、HTTP响应状态代码**

![在这里插入图片描述](https://img-blog.csdnimg.cn/3bba242a3f4d456bb483f76e07e5c9df.png)

#### 3.2.5 Cookie技术（HTTP拓展技术）

> - HTTP协议无状态，但是很多服务需要记录（如购物）；cookie用来记录状态；

![在这里插入图片描述](https://img-blog.csdnimg.cn/721284a313264317b6204d718c17a8be.png)

- **1、Cookie的原理**

![在这里插入图片描述](https://img-blog.csdnimg.cn/4f73fc3fc73646fa8c2d2f4840d27ced.png)

- **2、Cookie的作用**

![在这里插入图片描述](https://img-blog.csdnimg.cn/9b1f10e98ec64f2fa7571614cb3f4e93.png)

#### 3.2.6 Web缓存/代理服务器技术

- **1、Web缓存/代理服务器技术**

![在这里插入图片描述](https://img-blog.csdnimg.cn/84ec7a9354f74882ad234c57d5911efd.png)

- **2、Web缓存示例**

![在这里插入图片描述](https://img-blog.csdnimg.cn/1c5299721fea4d3e9979ef26b323ecd8.png)

> - 扩大链路带宽，成本高；

![在这里插入图片描述](https://img-blog.csdnimg.cn/7251a530bc0246299649ff6681f37b83.png)

> - 使用代理服务器

![在这里插入图片描述](https://img-blog.csdnimg.cn/d9ff8f404a0a45879b0844687a0ca12d.png)

> - 代理服务器的更新问题；

- **3、条件性GET方法**

![在这里插入图片描述](https://img-blog.csdnimg.cn/7fc1014b21ad49468b801fe144b56946.png)

### 3.3 Email应用(SMTP)

#### 3.3.1 Email应用的构成

![在这里插入图片描述](https://img-blog.csdnimg.cn/465df96c23aa4899ba0225b6547cda72.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/87c4f0fe270b43acbdebbcf591f54825.png)

> - 自己的客户端不会24小时一直开着，进行接收；

#### 3.3.2 SMTP协议：RFC 2821

> - SMTP：命令和响应的模式；
> - HTTP：请求和响应的模式；

![在这里插入图片描述](https://img-blog.csdnimg.cn/ccb58acfd56d4711b0cd3080c3ae2bd5.png)

- **Email应用示例（异步应用）**

![在这里插入图片描述](https://img-blog.csdnimg.cn/faa721341ee84dbab81a5deca790c907.png)

- **SMTP交互示例**

![在这里插入图片描述](https://img-blog.csdnimg.cn/8cd59266d4624fefa7df714f3367a2a8.png)

- **SMTP协议**

![在这里插入图片描述](https://img-blog.csdnimg.cn/1fa6b0a04ef642788c4a993efce1d550.png)

#### 3.3.3 Email消息格式

- **1、Email基本格式**

![在这里插入图片描述](https://img-blog.csdnimg.cn/516ad819a0714083adcc3b695862849f.png)

- **2、Email消息格式：多媒体扩展**

![在这里插入图片描述](https://img-blog.csdnimg.cn/579e0ffa5c6541caa7893d803751ec0c.png)

- **3、邮件访问协议（POP和IMAP）**

> - 发送邮件、邮件服务器之间的通信都是SMTP，但是从服务器获取邮件是使用邮件访问协议；

![在这里插入图片描述](https://img-blog.csdnimg.cn/74617336c9204ab68f160fbaffbc303c.png)

- **4、POP协议**

![在这里插入图片描述](https://img-blog.csdnimg.cn/84d61961f7004c6ba7904e7e5f7d6d65.png)

> - POP3协议有多种模式，

![在这里插入图片描述](https://img-blog.csdnimg.cn/206d902bffb74b24b6ced0425a653b31.png)

- **4、IMAP协议**

![在这里插入图片描述](https://img-blog.csdnimg.cn/d53e14d33eca4c68a81a1e2732939223.png)

### 3.4 DNS（Domin Name System）

> - 解决主机/路由器的识别问题；
> - 域名与IP地址的映射；

#### 3.4.1 DNS概述（域名解析系统）

![在这里插入图片描述](https://img-blog.csdnimg.cn/740a354cb2824936883011277017dd38.png)

> - 为很多主机/路由不间断完成翻译任务；变得挑战性；
> - 本身是DNS应用层协议；
> - 提供核心功能，但在应用层实现；

![在这里插入图片描述](https://img-blog.csdnimg.cn/d9828509b8344b37a8aed8ac90a4ae9d.png)

- **1、分布式层次式数据库**

![在这里插入图片描述](https://img-blog.csdnimg.cn/f24cbbc06d4a489ba6658430584d1970.png)

> - 缺点是需要进行三次查询；

- **2、DNS根域名服务器**

![在这里插入图片描述](https://img-blog.csdnimg.cn/a467a352f6dc45aaaf5a5a01557462fa.png)

- **3、TLD和权威域名解析服务器**

![在这里插入图片描述](https://img-blog.csdnimg.cn/effbeb103f8c4c338ca6a36222ca0259.png)

- **4、本地域名解析服务器**

> - 不属于层级体系

![在这里插入图片描述](https://img-blog.csdnimg.cn/5e6636ddbbaf43e78842447292106e37.png)

- **5、DNS查询示例**
    - **迭代查询**

![在这里插入图片描述](https://img-blog.csdnimg.cn/30f19394a9a443b2baa96aa4e91b29f3.png)

> - 先问本地Local，再问根域名服务器，root返回一个顶级地址，再问TLD域名服务器，再返回一个权威地址，再问权威域名服务器；获得IP地址；

- **递归查询**

![在这里插入图片描述](https://img-blog.csdnimg.cn/5663d776f1db48d79898c14fa73de914.png)

- **6、DNS记录缓存和更新**

![在这里插入图片描述](https://img-blog.csdnimg.cn/f68181e2e2104f59aedd883a60231bde.png)

#### 3.4.2 DNS记录和消息格式

- **1、DNS记录**

![在这里插入图片描述](https://img-blog.csdnimg.cn/beec59c414e646a78934a13429003c51.png)

- **2、DNS协议与消息**

> - DNS是查询和服务的模式，消息格式相同

![在这里插入图片描述](https://img-blog.csdnimg.cn/aba1ac5572c847d39e6697ae13b02a62.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/f390429a855c4f59916cd6f22bf7530e.png)

- **3、如何注册域名？**

![在这里插入图片描述](https://img-blog.csdnimg.cn/f09c3f266aa4423d8a095aed81a2c8e1.png)

### 3.5 P2P应用

> - 以上学习的WEB应用和DNS应用都是C/S客户端/服务器模式；
> - 下面学习P2P模式；

#### 3.5.1 P2P应用\_原理与文件分发

- **1、纯P2P架构**

![在这里插入图片描述](https://img-blog.csdnimg.cn/5fdeff3ceb3f45d69360182db5e0767f.png)

> - 缺点是比较复杂；

- **2、文件分发：客户机/服务器 vs P2P**
    - **文件分发：客户机/服务器**

![在这里插入图片描述](https://img-blog.csdnimg.cn/501a1cb049774b0eb11b86262dd2fed3.png)

> - 时间跟随N线性增长；只能由服务器将副本分别发给N个节点，

- **文件分发：P2P**

![在这里插入图片描述](https://img-blog.csdnimg.cn/e386e0b4a744429fb152e71f0e0d16d3.png)

> - 对于P2P，当服务器上传第一个副本给一个节点的时候，就可以开始了一个节点向其他节点开始传送；

![在这里插入图片描述](https://img-blog.csdnimg.cn/bbe9eef18ec449b4a0ec23c60703e5cc.png)

> - 可以看到，当节点数N不断增大，P2P的耗时趋于平稳，而服务器/客户端模式就线性增长；

- **3、文件分发：BitTorrent**

> - 典型协议Bit，P2P；

![在这里插入图片描述](https://img-blog.csdnimg.cn/90cc05ae163c46608dc619e9fe87a5c7.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/8ef77dcb91b145babdcd8ac3b79d43b8.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/bcfcb88d61624f73838b8fdcf8bd138f.png)

#### 3.5.2 P2P应用\_索引技术

- **1、P2P：搜索信息**

![在这里插入图片描述](https://img-blog.csdnimg.cn/3bdc75c5bd834159ac5c26db46cecdce.png)

- **2、集中式索引**

![在这里插入图片描述](https://img-blog.csdnimg.cn/932c6707da784f3289636a10cb141c5d.png)

> - 虽然文件分发是P2P的，但是查询文件位置，是需要问中央服务器；
> - 因此，存在以下问题：

![在这里插入图片描述](https://img-blog.csdnimg.cn/cb8f5f02efa943a3a7eee5d1e4a10c00.png)

- **3、洪范式查询：Query flooding**

![在这里插入图片描述](https://img-blog.csdnimg.cn/dd225eebfb5d461a95ad8ddb650098c5.png)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/46fca3a126a1468e884424cf5c66149f.png)

> - 向它连接的所有节点发送查询消息，然后再节点转发查询消息，找到位置后，反向索引；
> - 缺点：消息会像洪水一样泛滥在网络中，加重网络负担；
> - 综合以上两种方式，产生以下层次式覆盖网络

- **4、层次式覆盖网络**

![在这里插入图片描述](https://img-blog.csdnimg.cn/95fb261c2e8949b482771ae7f2b80646.png)

- **5、P2P案例应用：Skype**

![在这里插入图片描述](https://img-blog.csdnimg.cn/32b2565e60604fe3a1e894b05e3aa521.png)

### 3.6 Socket编程-应用编程接口

#### 3.6.1 典型的应用编程接口

- **1、网络程序设计接口**

![在这里插入图片描述](https://img-blog.csdnimg.cn/132f03d50ebe4905bdbd6be1228612b8.png)

- **2、应用编程接口API**

> - 应用进程控制与操作系统控制的传输层，之间的数据交互，就是通过接口API；

![在这里插入图片描述](https://img-blog.csdnimg.cn/3338b3a79dd74f4884f5d6634d0b29fd.png)

- **3、几种典型的应用编程接口**

> - 应用最广泛的就是套接字(socket)

![在这里插入图片描述](https://img-blog.csdnimg.cn/3c91859ef4464fdcac6ad20b2fffd44e.png)

#### 3.6.2 Socket API概述

> - socket套接字为服务器应用进程与客户端应用进程之间创建了一种抽象通信机制；

![在这里插入图片描述](https://img-blog.csdnimg.cn/b133211121054ad1aa8dcbb90adda504.png)

> - 每一个服务器/客户端可能有多个进程，产生多个套接字；
> - 当客户端的应用进程连接，怎么确定连接哪个套接字？
>     - IP地址+端口号（唯一确定对外）
>     - （对内是套接字描述符）

![在这里插入图片描述](https://img-blog.csdnimg.cn/731f0561dc3044b1a054b7990d56bfd9.png)

- **1、Scoket抽象**

> - 将Scoket看做一个特殊的文件；会有一个数据结构；
> - 每一个进程的套接字都会维护这个数据结构；

![在这里插入图片描述](https://img-blog.csdnimg.cn/39c359ed4f9f4cf2ba3040bbb07fa0af.png)

- **2、地址结构**

![在这里插入图片描述](https://img-blog.csdnimg.cn/0c2c0ff577904107a836349946bc6954.png)

#### 3.6.3 Socket API函数（WinSock）1

> - 一般以WSA开头的API扩展函数

![在这里插入图片描述](https://img-blog.csdnimg.cn/4c6b90a846c044e6a868a3f30d6509ea.png)

> - 首先调用`WSAStartup`初始化，最后要调用`WSACleanup`释放动态链接库；

- **1、WSAStartup**

![在这里插入图片描述](https://img-blog.csdnimg.cn/5ac157f10df94cf589a3ff80e79aad83.png)

> - 两个参数：一个是WinSock版本，一个是数据结构的指针；

- **2、WSACleanup**

![在这里插入图片描述](https://img-blog.csdnimg.cn/06da986132174148850865e52ffa9cfc.png)

- **3、socket**

![在这里插入图片描述](https://img-blog.csdnimg.cn/08f315dae64f4df5bf4a1c6935507645.png)

> - 第一个参数，是说明确定是哪个传输层协议簇；
> - 第二个参数，创建哪种套接字；第三个参数

- **4、Socket面向TCP/IP的服务类型**

![在这里插入图片描述](https://img-blog.csdnimg.cn/ae4a396da83d45779b998e9cc47a1e8d.png)

> - 套接字架起了传输层与应用层之间的数据交换；
> - 还有跟网络层交互；称为SOCK\_RAW原始套接字，一般需要特殊权限（root）

- **5、Closesocket**

![在这里插入图片描述](https://img-blog.csdnimg.cn/53fa1740e2774b2e8c3a31b1b8c79eb8.png)

- **6、bind（绑定本地地址端口号）**

![在这里插入图片描述](https://img-blog.csdnimg.cn/593cd20cb8ee4f3c94d1351d698856c9.png)

> - 服务端bind，客户端不需要，会自动调用分配；

![在这里插入图片描述](https://img-blog.csdnimg.cn/2677a309aa8246d88bccb50658bb53ed.png)

> - bind返回地址通配符，而不指定特定IP地址；

#### 3.6.4 Socket API函数（WinSock）2

- **1、listen（服务端置监听模式，等待连接）**

![在这里插入图片描述](https://img-blog.csdnimg.cn/17313d7d356c484eb85174f34a1b6f97.png)

> - 多个客户端发起套接字请求，就有等待队列；

- **2、connect（客户端专用）**

![在这里插入图片描述](https://img-blog.csdnimg.cn/98cd804d50c448a78e0cebbffbbe88a5.png)

- **3、accept（服务器专用，返回一个新套接字）**

![在这里插入图片描述](https://img-blog.csdnimg.cn/bb51f5f7064c4c2c915ef6f2b65dd14a.png)

- **4、send，sendto（发送数据）**

![在这里插入图片描述](https://img-blog.csdnimg.cn/d222d1166dfe4cb5970dbedf5dea42c6.png)

- **5、recv、recvfrom（接收数据）**

![在这里插入图片描述](https://img-blog.csdnimg.cn/fa64bb3ba89e44b58e253a91b610a28b.png)

- **6、setsockopt,getsockopt(设置套接字参数，读取套接字参数)**  
    ![在这里插入图片描述](https://img-blog.csdnimg.cn/3664e91372fa42bcb27335e8269ac324.png)
    
- **7、Scoket API函数小结**
  

![在这里插入图片描述](https://img-blog.csdnimg.cn/786b8a0ac88340738d6777158b3dc3de.png)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/1aafdc3b35424b24b06a900e18a66926.png)

- **8、关于网络字节顺序**

![在这里插入图片描述](https://img-blog.csdnimg.cn/c0af2447d09e48fc970f5468155627bb.png)

#### 3.6.5 网络应用的Socket API(TCP)调用

- **1、Socket API（TCP）调用基本流程**

![在这里插入图片描述](https://img-blog.csdnimg.cn/8f3dbfe6d57f47a380347608b2ad345f.png)

#### 3.6.6 Socket编程-客户端软件设计

- **1、解析服务器IP地址**

![在这里插入图片描述](https://img-blog.csdnimg.cn/db9442a1a8ad499ea754952cf5c66bf4.png)

- **2、解析服务器（熟知）端口号**

![在这里插入图片描述](https://img-blog.csdnimg.cn/f8595af32d7a4b8a95fa69e2238cf7f7.png)

- **3、解析协议号**

![在这里插入图片描述](https://img-blog.csdnimg.cn/5c9114f6c1ab4ed496d219df06671643.png)

- **4、TCP客户端软件流程**

![在这里插入图片描述](https://img-blog.csdnimg.cn/24933f1fe9924b2d8c3a99c8558b26aa.png)

> - 绿色是包含函数中自动完成的，不需要我们设置；

- **5、UDP客户端软件流程**

![在这里插入图片描述](https://img-blog.csdnimg.cn/e583052694b94f8d9603edda45292188.png)

- **6、客户端软件的实现-connectsock()**

![在这里插入图片描述](https://img-blog.csdnimg.cn/c8bfd123e9f744109f99eb8f97c2dae1.png)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/4cc52884eb884df5977081e366a2c75a.png)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/894a56fd1d2c4beabd309a21ff983ec4.png)

- **7、客户端软件的实现-UDP客户端**

![在这里插入图片描述](https://img-blog.csdnimg.cn/7d8bb6d3c471463d9e7ebac4a75a0d55.png)

- **8、客户端软件的实现-TCP客户端**

![在这里插入图片描述](https://img-blog.csdnimg.cn/ff5ac6d7180b41ee804fc2427ce4a4a2.png)

- **9、客户端软件的实现-异常处理**

![在这里插入图片描述](https://img-blog.csdnimg.cn/3cf15dc049424cd8be51fc253ae8f305.png)

#### 3.6.7 Socket编程-服务器软件设计

- **1、四种类型基本服务器**

![在这里插入图片描述](https://img-blog.csdnimg.cn/1ae4965cf2f44aa3b5229f4746d6a6cb.png)

- **2、循环无连接服务器基本流程**

> - 循环：一次只处理一个客户端，结束之后再处理下一个，无连接：UDP

![在这里插入图片描述](https://img-blog.csdnimg.cn/a60b7e63951f4b7da1389f99cea37a53.png)

- **数据发送**  
    ![在这里插入图片描述](https://img-blog.csdnimg.cn/67b9141ae0024c4092bc5466e43b1694.png)

> - 参数分别是，
>     - socket：服务器（UDP）套接字；
>     - data：一个指针，指向存储待发送数据缓存的地址；
>     - length：缓存中数据字节数；
>     - flags：调试或控制选项；
>     - destaddr：指向结构sockaddr\_in的指针（客户端端点地址）；
>     - addrlen：地址结构长度；

- **获取客户端点地址**

![在这里插入图片描述](https://img-blog.csdnimg.cn/d95f833ef6094989a7d8f8dbcf6a6b1c.png)

> - 参数分别是：
>     - socket：（UDP）服务器套接字；
>     - buf：一个指针，指向存放数据报的缓存地址；
>     - length：缓存可用空间；
>     - flags：调试或控制选项；
>     - from：存放源地址的缓存地址，就是客户端点地址；
>     - fromlen：源地址长度

- **3、循环面向连接服务器基本流程**

![在这里插入图片描述](https://img-blog.csdnimg.cn/1616081770d84f6d8e2a780235d35da1.png)

- **4、并发无连接服务器基本流程**

> - 创建新线程；

![在这里插入图片描述](https://img-blog.csdnimg.cn/c09151a39c6143c9acb9ff2ed516e341.png)

- **5、并发面向连接服务器基本流程**

![在这里插入图片描述](https://img-blog.csdnimg.cn/d1f711dc47864ae8884feed76b7a977f.png)

- **6、服务器的实现**

![在这里插入图片描述](https://img-blog.csdnimg.cn/420ceedb0aaf43e28c8b613594066cde.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/02d2bbd074fb46f69db34d18093371a7.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/1e0f59368bf943469dcbcba2bc2ad877.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/84c1e6e0e8a843f3acebbc01b0131a95.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/655d6aa64aac467ea03da1ab5a301891.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/c4929590e8e241abb3c8b74a579c3840.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/189a4efc98fe4797a931931dbd54ca61.png)